<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Popup Video Example</title>
</head>
<body>
<h2>Click the button to open bouncing video popups</h2>
<button id="start-btn">Open Popups</button>

<script>
const NUM_POPUPS = 3; // number of popups
const POPUP_WIDTH = 400;
const POPUP_HEIGHT = 300;
const popups = [];
const velocities = [];

document.getElementById("start-btn").addEventListener("click", () => {
    for (let i = 0; i < NUM_POPUPS; i++) {
        // Open a new window
        const popup = window.open(
            "",
            "_blank",
            `width=${POPUP_WIDTH},height=${POPUP_HEIGHT},left=${100 + i*50},top=${100 + i*50}`
        );

        if (!popup) {
            alert("Popup blocked by browser!");
            return;
        }

        // Add video inside the popup
        popup.document.write(`
            <html>
            <head>
            <title>Video Popup</title>
            <style>
                body { margin: 0; overflow: hidden; background: black; }
                video { width: 100%; height: 100%; object-fit: cover; }
            </style>
            </head>
            <body>
                <video src="./video.mp4" autoplay loop muted playsinline></video>
            </body>
            </html>
        `);

        // Random velocity
        const dx = (Math.random() * 4 + 2) * (Math.random() < 0.5 ? 1 : -1);
        const dy = (Math.random() * 4 + 2) * (Math.random() < 0.5 ? 1 : -1);
        velocities.push({dx, dy});

        popups.push(popup);
    }

    // Animate bouncing popups
    function animate() {
        popups.forEach((popup, i) => {
            if (popup.closed) return;

            let x = popup.screenX;
            let y = popup.screenY;
            let dx = velocities[i].dx;
            let dy = velocities[i].dy;

            // Bounce off screen edges
            const screenW = window.screen.width;
            const screenH = window.screen.height;

            if (x + POPUP_WIDTH >= screenW || x <= 0) velocities[i].dx *= -1;
            if (y + POPUP_HEIGHT >= screenH || y <= 0) velocities[i].dy *= -1;

            popup.moveBy(velocities[i].dx, velocities[i].dy);
        });

        requestAnimationFrame(animate);
    }

    animate();
});
</script>
</body>
</html>
